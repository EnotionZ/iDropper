(function(y){var i=function(N){return typeof N==="string"&&N.match(/^#?[0-9a-fA-F]{6}$/i);},L=function(O,R,Q){var P,S=O/60,N=R*(1-Math.abs(S%2-1));if(S<1){P=[R,N,0];}else{if(S<2){P=[N,R,0];}else{if(S<3){P=[0,R,N];}else{if(S<4){P=[0,N,R];}else{if(S<5){P=[N,0,R];}else{if(S<6){P=[R,0,N];}}}}}}return[parseInt(255*(P[0]+Q),10),parseInt(255*(P[1]+Q),10),parseInt(255*(P[2]+Q),10)];},c=function(P){var S=P[0],R=P[1],O=P[2],T=(1-Math.abs(2*O-1))*R,N=O-0.5*T,Q=[];return L(S,T,N);},j=function(Q){var S=Q[0],R=Q[1],O=Q[2],T=O*R,N=O-T,P=[];return L(S,T,N);},F=function(N){var P=[],Q;if(N[3]===0){return"transparent";}for(var O=0;O<3;O++){Q=(N[O]-0).toString(16);P.push(Q.length==1?("0"+Q):Q);}return"#"+P.join("");},k=function(O){var N;if(typeof O==="string"){if(i(O)){return O;}N=O.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);if(N){N.shift();O=N;}}if(typeof O!=="object"||!(O instanceof Array)){return null;}else{return F(O);}},h=function(O){O=O.replace(/#/g,"");if(O.length!==6){return false;}var N=parseInt(O.substr(0,2),16);g=parseInt(O.substr(2,2),16);b=parseInt(O.substr(4,2),16);return[N,g,b];},J=function(T){var N=T[0]/255,R=T[1]/255,U=T[2]/255,V=Math.max(N,R,U),P=Math.min(N,R,U),S,Q,W,O=(V+P)/2;if(V===P){Q=W=0;}else{S=V-P;W=O>0.5?S/(2-V-P):S/(V+P);switch(V){case N:Q=(R-U)/S+(R<U?6:0);break;case R:Q=(U-N)/S+2;break;case U:Q=(N-R)/S+4;break;}Q*=60;}return[Q,W,O];},E=function(S){var N=S[0]/255,Q=S[1]/255,T=S[2]/255,U=Math.max(N,Q,T),O=Math.min(N,Q,T),P,W,V=U,R=U-O;W=U===0?0:R/U;if(U===O){P=0;}else{switch(U){case N:P=(Q-T)/R+(Q<T?6:0);break;case Q:P=(T-N)/R+2;break;case T:P=(N-Q)/R+4;break;}P*=60;}return[P,W,V];},o=function(N){return J(h(N));},B=function(N){return F(c(N));},l=function(N){return E(h(N));},K=function(N){return F(j(N));},z=function(S,N,Q,P){if(N>Q){var O=N;N=Q;Q=O;}if(P){var R=Q-N;S=(S-N)%R;if(S<0){S+=R;}else{if(S>R){S-=R;}}S+=N;}else{if(S<0){S=N;}else{if(S>Q){S=Q;}}}return S;},s=function(P,O){if(typeof O!=="object"){return null;}var N=o(P);if(typeof O.h==="number"){N[0]=z(N[0]+O.h,0,360,true);}if(typeof O.s==="number"){N[1]=z(N[1]+O.s,0,1,O.wrap||O.swrap);}if(typeof O.l==="number"){N[2]=z(N[2]+O.l,0,1,O.wrap||O.lwrap);}return B(N);},p=function(N,O){return s(N,{l:O});},m=function(N,O){return p(N,-O);},G=function(N,O){return s(N,{s:O});},v=function(N,O){return G(N,-O);},a=function(O,N){return s(O,{h:N});},C=function(N){return s(N,{h:180});};y.iDropper={lighten:p,darken:m,saturate:G,desaturate:v,changeHue:a,complement:C,changeColor:s,RgbToHex:k};var M=y("html,body");var x=y("body");var q=null;var I={preventGhost:function(){return false;},mouseup:function(N){if(q){q.trigger("mouseup",N);}q=null;},mousemove:function(N){if(q){q.trigger("mousedrag",N);}}};x.bind("mousemove.iDfn",I.mousemove);x.bind("mouseup.iDfn",I.mouseup);x.delegate("img.iD-pick","mousedown",I.preventGhost);var A=y("<div/>").appendTo(x),w={SATVAL:A.attr("class","iD-img-sv").css("background-image").replace(/"/g,"").replace(/url\(|\)$/ig,""),HUEBAR:A.attr("class","iD-img-huebar").css("background-image").replace(/"/g,"").replace(/url\(|\)$/ig,""),HUERING:A.attr("class","iD-img-huering").css("background-image").replace(/"/g,"").replace(/url\(|\)$/ig,"")};A.remove();var u=256,f=482,H=50/2,D=(f/2-H)/f,d=360/(2*Math.PI),r=/MSIE (\d+\.\d+);/.test(navigator.userAgent)?parseFloat(RegExp.$1):NaN,t=r===6,n=[8,9,37,38,39,40,48,49,50,51,52,53,54,55,56,57,65,66,67,68,69,70,86,96,97,98,99,100,101,102,103,104,105];var e=function(ac){this.el=ac.$el;this.hooks={};this.hideHash=ac.hideHash;var ag=this,af=ac.size||u,N=f*af/u,ae=N/2,ai=N*D,O=[0,1,1],am=ac.layout==="ring"?"ring":"bar",P={type:"",tx:0,ty:0},T=false;var ap=ac.$el,V=y("<div/>").addClass("iD iD-layout-"+am).appendTo(ap),an=y("<div/>").addClass("iD-sv-container iD-sv-container-"+am).appendTo(V),Z=y("<img/>").addClass("iD-img").attr("src",w.SATVAL).appendTo(an),aa=y("<div/>").addClass("iD-indicator-color").appendTo(an),W=y("<div/>").addClass("iD-cover-color iD-pick iD-sv-pick").appendTo(an),ah=y("<div/>").addClass("iD-hue-container iD-hue-container-"+am).appendTo(V),Y=y("<img/>").addClass("iD-img").attr("src",(am==="ring"?w.HUERING:w.HUEBAR)).appendTo(ah),ab=y("<div/>").addClass("iD-indicator-hue").appendTo(ah),U=y("<div/>").addClass("iD-cover-hue iD-pick iD-hue-pick").appendTo(ah),al=y("<div/>").addClass("iD-preview-input").appendTo(V),ad=y("<div/>").addClass("iD-preview").appendTo(al),ao=y("<div/>").addClass("iD-input-container").appendTo(al),R=y("<input/>").addClass("iD-input-field").attr("type","text").appendTo(ao);var X={set:function(aq,ar){aq=X.setColor(aq);if(aq){X.updateInput(aq);if(!ar){ag.trigger("change",aq);}}return aq;},setColor:function(ar){ar=k(ar);if(i(ar)){var aq=l(ar);O=aq;if(am==="ring"){X.huedrag({theta:(270-aq[0])/d});}else{X.huedrag({y:af-af*aq[0]/360});}X.svdrag({x:af*aq[1],y:af*(1-aq[2])});ar=X.setPreview(ar);return ar;}},setFlag:function(au,aq){var ar=au.manual?au:y(au.target).offset(),at=M.scrollTop()||x.scrollTop()||0;ar.left-=M.scrollLeft();ar.top-=at;P={type:aq,tx:ar.left,ty:ar.top};q=ag;},setSVFlag:function(aq){X.setFlag(aq,"svdrag");X.mousedrag(aq);},setHueFlag:function(aq){X.setFlag(aq,"huedrag");X.mousedrag(aq);},inputKeydown:function(aq){return(y.inArray(aq.keyCode,n)!==-1);},inputKeyup:function(ar){var aq=X.setColor(R.val());if(aq){ag.trigger("change",aq);}return false;},mousedown:function(aq){T=true;ag.trigger("start",K(O));},mouseup:function(ar){var aq=K(O);if(T){ag.trigger("end",aq);ag.trigger("change",aq);}T=false;},mousedrag:function(at){var ar,aq={x:at.clientX-P.tx,y:at.clientY-P.ty};if(aq.x<0){aq.x=0;}if(aq.y<0){aq.y=0;}X[P.type](aq);if(ar=X.setPreview()){X.updateInput(ar);ag.trigger("drag",ar);}},huedrag:function(ar){var au;if(am==="ring"){var aq,aw,at,av;if(ar.theta){at=ar.theta;}else{if(ar.y>N){ar.y=N;}aq=ar.x-ae;aw=ar.y-ae;if(aq===0){aq=1e-8;}if(aw===0){aw=1e-8;}at=Math.atan(aw/aq);av=90-at*d;if((aq>0&&aw>0)||(aq>0&&aw<0)){av+=180;}O[0]=parseInt(av-1,10);}aq=parseInt(ai*Math.cos(at)+ae,10);aw=parseInt(ai*Math.sin(at)+ae,10);if(ar.x<ae){aq=N-aq;aw=N-aw;}ab.css({top:aw,left:aq});}else{if(am==="bar"){if(ar.y>af){ar.y=af-1;}O[0]=parseInt(360*(1-ar.y/af),10);if(O[0]>=360){O[0]=359;}ab.css({top:ar.y});}}an.css("background-color",au=X.getHex([O[0],1,1]));},svdrag:function(aq){if(aq.x>af){aq.x=af;}if(aq.y>af){aq.y=af;}aa.css({left:aq.x-3,top:aq.y-3});O[1]=aq.x/af;O[2]=1-aq.y/af;},getHex:function(aq){if(!aq){aq=O;}return F(j(aq));},setPreview:function(aq){if(!aq){aq=X.getHex();}if(i(aq)){if(aq.charAt(0)!=="#"){aq="#"+aq;}ad.css("background-color",aq);return aq;}},updateInput:function(aq){if(ag.hideHash){aq=aq.substr(1);}R.val(aq);}};var Q=[[".iD-hue-pick","mousedown","mousedown"],[".iD-hue-pick","mousedown","setHueFlag"],[".iD-sv-pick","mousedown","mousedown"],[".iD-sv-pick","mousedown","setSVFlag"],[".iD-input-field","keyup","inputKeyup"],[".iD-input-field","keydown","inputKeydown"]];for(var aj=0,ak=Q.length;aj<ak;aj++){ap.find(Q[aj][0]).bind(Q[aj][1],X[Q[aj][2]]);}this.bind("mousedrag",X.mousedrag);this.bind("mouseup",X.mouseup);if(typeof ac.onChange==="function"){this.bind("change",ac.onChange);}if(typeof ac.onStart==="function"){this.bind("start",ac.onStart);}if(typeof ac.onDrag==="function"){this.bind("drag",ac.onDrag);}if(typeof ac.onEnd==="function"){this.bind("end",ac.onEnd);}this.set=X.set;this.utils=y.iDropper;var S=parseInt(af/13,10);if(typeof ac.size==="number"){an.css({width:af,height:af});if(am==="ring"){V.css({width:N,height:N});ah.css({width:N,height:N});}else{ah.css({width:S,height:af});}}if(r){x.addClass("ie ie"+r);}if(t){if(am==="ring"){Y.remove();y("<span/>").addClass("iD-ie6huefix iD-pick").prependTo(ah).height(N);}Z.remove();y("<span/>").addClass("iD-ie6svfix iD-pick").prependTo(an).height(af);}ac.color=ac.color||"#ff0000";X.set(ac.color,true);};e.prototype.bind=function(O,N){if(typeof N!=="function"){return this;}if(!this.hooks[O]){this.hooks[O]=[];}this.hooks[O].push(N);return this;};e.prototype.trigger=function(Q,R,P){var O=this.hooks[Q];if(!O){return false;}for(var N=0;N<O.length;N++){if(P){O[N].call(P,R);}else{O[N](R);}}};y.fn.iDropper=function(O){var N=this;return N.each(function(Q){var P=N.eq(Q),R={$el:P};y.extend(R,O);P.data("iDropper",new e(R));});};})(jQuery);
