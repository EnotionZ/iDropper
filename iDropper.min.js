(function(z){var i=function(O){return typeof O==="string"&&O.match(/^#?[0-9a-fA-F]{6}$/i);},M=function(P,S,R){var Q,T=P/60,O=S*(1-Math.abs(T%2-1));if(T<1){Q=[S,O,0];}else{if(T<2){Q=[O,S,0];}else{if(T<3){Q=[0,S,O];}else{if(T<4){Q=[0,O,S];}else{if(T<5){Q=[O,0,S];}else{if(T<6){Q=[S,0,O];}}}}}}return[parseInt(255*(Q[0]+R),10),parseInt(255*(Q[1]+R),10),parseInt(255*(Q[2]+R),10)];},c=function(Q){var T=Q[0],S=Q[1],P=Q[2],U=(1-Math.abs(2*P-1))*S,O=P-0.5*U,R=[];return M(T,U,O);},j=function(R){var T=R[0],S=R[1],P=R[2],U=P*S,O=P-U,Q=[];return M(T,U,O);},G=function(O){var Q=[],R;if(O[3]===0){return"transparent";}for(var P=0;P<3;P++){R=(O[P]-0).toString(16);Q.push(R.length==1?("0"+R):R);}return"#"+Q.join("");},k=function(P){var O;if(typeof P==="string"){if(i(P)){return P;}O=P.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);if(O){O.shift();P=O;}}if(typeof P!=="object"||!(P instanceof Array)){return null;}else{return G(P);}},h=function(P){P=P.replace(/#/g,"");if(P.length!==6){return false;}var O=parseInt(P.substr(0,2),16);g=parseInt(P.substr(2,2),16);b=parseInt(P.substr(4,2),16);return[O,g,b];},K=function(U){var O=U[0]/255,S=U[1]/255,V=U[2]/255,W=Math.max(O,S,V),Q=Math.min(O,S,V),T,R,X,P=(W+Q)/2;if(W===Q){R=X=0;}else{T=W-Q;X=P>0.5?T/(2-W-Q):T/(W+Q);switch(W){case O:R=(S-V)/T+(S<V?6:0);break;case S:R=(V-O)/T+2;break;case V:R=(O-S)/T+4;break;}R*=60;}return[R,X,P];},F=function(T){var O=T[0]/255,R=T[1]/255,U=T[2]/255,V=Math.max(O,R,U),P=Math.min(O,R,U),Q,X,W=V,S=V-P;X=V===0?0:S/V;if(V===P){Q=0;}else{switch(V){case O:Q=(R-U)/S+(R<U?6:0);break;case R:Q=(U-O)/S+2;break;case U:Q=(O-R)/S+4;break;}Q*=60;}return[Q,X,W];},o=function(O){return K(h(O));},C=function(O){return G(c(O));},l=function(O){return F(h(O));},L=function(O){return G(j(O));},p=function(Q){var U=Q[0],T=Q[1],P=Q[2],O=P-0.5*P*T,R=P*T/(1-Math.abs(2*O-1));return[U,R,O];},A=function(T,O,R,Q){if(O>R){var P=O;O=R;R=P;}if(Q){var S=R-O;T=(T-O)%S;if(T<0){T+=S;}else{if(T>S){T-=S;}}T+=O;}else{if(T<0){T=O;}else{if(T>R){T=R;}}}return T;},u=function(Q,P){if(typeof P!=="object"){return null;}var O;if(i(Q)){O=o(Q);}else{if(Object.prototype.toString.call(Q)==="[object Array]"&&Q.length===3){O=[Q[0],Q[1],Q[2]];}else{return null;}}if(typeof P.h==="number"){O[0]=A(O[0]+P.h,0,360,true);}if(typeof P.s==="number"){O[1]=A(O[1]+P.s,0,1,P.wrap||P.swrap);}if(typeof P.l==="number"){O[2]=A(O[2]+P.l,0,1,P.wrap||P.lwrap);}return C(O);},q=function(O,P){return u(O,{l:P});},m=function(O,P){return q(O,-P);},H=function(O,P){return u(O,{s:P});},w=function(O,P){return H(O,-P);},a=function(P,O){return u(P,{h:O});},D=function(O){return u(O,{h:180});};z.iDropper={lighten:q,darken:m,saturate:H,desaturate:w,changeHue:a,complement:D,changeColor:u,RgbToHex:k,HslToHex:C};var N=z("html,body");var y=z("body");var r=null;var J={preventGhost:function(){return false;},mouseup:function(O){if(r){r.trigger("mouseup",O);}r=null;},mousemove:function(O){if(r){r.trigger("mousedrag",O);}}};y.bind("mousemove.iDfn",J.mousemove);y.bind("mouseup.iDfn",J.mouseup);y.delegate("img.iD-pick","mousedown",J.preventGhost);var B=z("<div/>").appendTo(y),x={SATVAL:B.attr("class","iD-img-sv").css("background-image").replace(/"/g,"").replace(/url\(|\)$/ig,""),HUEBAR:B.attr("class","iD-img-huebar").css("background-image").replace(/"/g,"").replace(/url\(|\)$/ig,""),HUERING:B.attr("class","iD-img-huering").css("background-image").replace(/"/g,"").replace(/url\(|\)$/ig,"")};B.remove();var v=256,f=482,I=50/2,E=(f/2-I)/f,d=360/(2*Math.PI),s=/MSIE (\d+\.\d+);/.test(navigator.userAgent)?parseFloat(RegExp.$1):NaN,t=s===6,n=[8,9,37,38,39,40,48,49,50,51,52,53,54,55,56,57,65,66,67,68,69,70,86,96,97,98,99,100,101,102,103,104,105];var e=function(ad){this.el=ad.$el;this.hooks={};this.hideHash=ad.hideHash;var ah=this,ag=ad.size||v,O=f*ag/v,af=O/2,aj=O*E,P=[0,1,1],an=ad.layout==="ring"?"ring":"bar",Q={type:"",tx:0,ty:0},U=false;var aq=ad.$el,W=z("<div/>").addClass("iD iD-layout-"+an).appendTo(aq),ao=z("<div/>").addClass("iD-sv-container iD-sv-container-"+an).appendTo(W),aa=z("<img/>").addClass("iD-img").attr("src",x.SATVAL).appendTo(ao),ab=z("<div/>").addClass("iD-indicator-color").appendTo(ao),X=z("<div/>").addClass("iD-cover-color iD-pick iD-sv-pick").appendTo(ao),ai=z("<div/>").addClass("iD-hue-container iD-hue-container-"+an).appendTo(W),Z=z("<img/>").addClass("iD-img").attr("src",(an==="ring"?x.HUERING:x.HUEBAR)).appendTo(ai),ac=z("<div/>").addClass("iD-indicator-hue").appendTo(ai),V=z("<div/>").addClass("iD-cover-hue iD-pick iD-hue-pick").appendTo(ai),am=z("<div/>").addClass("iD-preview-input").appendTo(W),ae=z("<div/>").addClass("iD-preview").appendTo(am),ap=z("<div/>").addClass("iD-input-container").appendTo(am),S=z("<input/>").addClass("iD-input-field").attr("type","text").appendTo(ap);var Y={set:function(ar,at){ar=Y.setColor(ar);if(ar){Y.updateInput(ar);if(!at){ah.trigger("change",ar,ah.hsl);}}return ar;},setColor:function(at){at=k(at);if(i(at)){var ar=l(at);P=ar;ah.hex=at;ah.hsl=p(ar);if(an==="ring"){Y.huedrag({theta:(270-ar[0])/d});}else{Y.huedrag({y:ag-ag*ar[0]/360});}Y.svdrag({x:ag*ar[1],y:ag*(1-ar[2])});at=Y.setPreview(at);return at;}},setFlag:function(av,ar){var at=av.manual?av:z(av.target).offset(),au=N.scrollTop()||y.scrollTop()||0;at.left-=N.scrollLeft();at.top-=au;Q={type:ar,tx:at.left,ty:at.top};r=ah;},setSVFlag:function(ar){Y.setFlag(ar,"svdrag");Y.mousedrag(ar);},setHueFlag:function(ar){Y.setFlag(ar,"huedrag");Y.mousedrag(ar);},inputKeydown:function(ar){return(z.inArray(ar.keyCode,n)!==-1);},inputKeyup:function(at){var ar=Y.setColor(S.val());if(ar){ah.trigger("change",ar,ah.hsl);}return false;},mousedown:function(ar){U=true;ah.trigger("start",ah.hex,ah.hsl);},mouseup:function(ar){if(U){ah.trigger("end",ah.hex,ah.hsl);ah.trigger("change",ah.hex,ah.hsl);}U=false;},mousedrag:function(au){var at,ar={x:au.clientX-Q.tx,y:au.clientY-Q.ty};if(ar.x<0){ar.x=0;}if(ar.y<0){ar.y=0;}Y[Q.type](ar);if(at=Y.setPreview()){ah.hex=at;ah.hsl=p(P);Y.updateInput(at);ah.trigger("drag",at,ah.hsl);}},huedrag:function(at){var av;if(an==="ring"){var ar,ax,au,aw;if(at.theta){au=at.theta;}else{if(at.y>O){at.y=O;}ar=at.x-af;ax=at.y-af;if(ar===0){ar=1e-8;}if(ax===0){ax=1e-8;}au=Math.atan(ax/ar);aw=90-au*d;if((ar>0&&ax>0)||(ar>0&&ax<0)){aw+=180;}P[0]=parseInt(aw-1,10);}ar=parseInt(aj*Math.cos(au)+af,10);ax=parseInt(aj*Math.sin(au)+af,10);if(at.x<af){ar=O-ar;ax=O-ax;}ac.css({top:ax,left:ar});}else{if(an==="bar"){if(at.y>ag){at.y=ag-1;}P[0]=parseInt(360*(1-at.y/ag),10);if(P[0]>=360){P[0]=359;}ac.css({top:at.y});}}ao.css("background-color",av=Y.getHex([P[0],1,1]));},svdrag:function(ar){if(ar.x>ag){ar.x=ag;}if(ar.y>ag){ar.y=ag;}ab.css({left:ar.x-3,top:ar.y-3});P[1]=ar.x/ag;P[2]=1-ar.y/ag;},getHex:function(ar){if(!ar){ar=P;}return G(j(ar));},setPreview:function(ar){if(!ar){ar=Y.getHex();}if(i(ar)){if(ar.charAt(0)!=="#"){ar="#"+ar;}ae.css("background-color",ar);return ar;}},updateInput:function(ar){if(ah.hideHash){ar=ar.substr(1);}S.val(ar);},colorMath:function(ar,at){if(at){ah.set(ar);}return ar;},darken:function(ar,at){return Y.colorMath(m(ah.hsl,ar),at);},lighten:function(ar,at){return Y.colorMath(q(ah.hsl,ar),at);},saturate:function(ar,at){return Y.colorMath(H(ah.hsl,ar),at);},desaturate:function(ar,at){return Y.colorMath(w(ah.hsl,ar),at);},changeHue:function(ar,at){return Y.colorMath(a(ah.hsl,ar),at);},complement:function(ar,at){return Y.colorMath(D(ah.hsl,ar),at);},changeColor:function(ar,at){return Y.colorMath(u(ah.hsl,ar),at);}};var R=[[".iD-hue-pick","mousedown","mousedown"],[".iD-hue-pick","mousedown","setHueFlag"],[".iD-sv-pick","mousedown","mousedown"],[".iD-sv-pick","mousedown","setSVFlag"],[".iD-input-field","keyup","inputKeyup"],[".iD-input-field","keydown","inputKeydown"]];for(var ak=0,al=R.length;ak<al;ak++){aq.find(R[ak][0]).bind(R[ak][1],Y[R[ak][2]]);}this.bind("mousedrag",Y.mousedrag);this.bind("mouseup",Y.mouseup);if(typeof ad.onChange==="function"){this.bind("change",ad.onChange);}if(typeof ad.onStart==="function"){this.bind("start",ad.onStart);}if(typeof ad.onDrag==="function"){this.bind("drag",ad.onDrag);}if(typeof ad.onEnd==="function"){this.bind("end",ad.onEnd);}this.set=Y.set;this.darken=Y.darken;this.lighten=Y.lighten;this.saturate=Y.saturate;this.desaturate=Y.desaturate;this.changeHue=Y.changeHue;this.complement=Y.complement;this.changeColor=Y.changeColor;this.utils=z.iDropper;var T=parseInt(ag/13,10);if(typeof ad.size==="number"){ao.css({width:ag,height:ag});if(an==="ring"){W.css({width:O,height:O});ai.css({width:O,height:O});}else{ai.css({width:T,height:ag});}}if(s){y.addClass("ie ie"+s);}if(t){if(an==="ring"){Z.remove();z("<span/>").addClass("iD-ie6huefix iD-pick").prependTo(ai).height(O);}aa.remove();z("<span/>").addClass("iD-ie6svfix iD-pick").prependTo(ao).height(ag);}ad.color=ad.color||"#ff0000";Y.set(ad.color,true);};e.prototype.bind=function(P,O){if(typeof O!=="function"){return this;}if(!this.hooks[P]){this.hooks[P]=[];}this.hooks[P].push(O);return this;};e.prototype.trigger=function(R){var Q=this.hooks[R],O;if(!Q){return false;}O=Array.prototype.slice.call(arguments,1);for(var P=0;P<Q.length;P++){Q[P].apply(this,O);}};z.fn.iDropper=function(P){var O=this;return O.each(function(R){var Q=O.eq(R),S={$el:Q};z.extend(S,P);Q.data("iDropper",new e(S));});};})(jQuery);